<!DOCTYPE html>
<html>
<head>
    <title>Manage Users</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

<header>
    <h1>Manage Users</h1>
</header>

<div class="list-box">

    <button class="btn" onclick="load()">Refresh</button>

    <table id="tbl">
        <thead>
            <tr>
                <th>UserId</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Actions</th>
            </tr>
        </thead>

        <tbody></tbody>
    </table>
</div>


<script>

async function load(){

    let res = await fetch("http://localhost:8080/api/admin/users");

    let list = await res.json();

    let body = document.querySelector("#tbl tbody");

    body.innerHTML="";

    list.forEach(u=>{

        body.innerHTML += `
            <tr>
                <td>${u.userId}</td>
                <td>${u.name}</td>
                <td>${u.email}</td>
                <td>${u.phone}</td>

                <td>
                    <button onclick="block(${u.userId})">Block</button>
                    <button onclick="unblock(${u.userId})">Unblock</button>
                    <button onclick="del(${u.userId})">Delete</button>
                </td>
            </tr>`;
    })

}

async function block(id){
    await fetch(`http://localhost:8080/api/admin/block/${id}`,{ method:"POST" });
    load();
}

async function unblock(id){
    await fetch(`http://localhost:8080/api/admin/unblock/${id}`,{ method:"POST" });
    load();
}

async function del(id){
    await fetch(`http://localhost:8080/api/admin/delete/${id}`,{ method:"POST" });
    load();
}

load();

</script>
</body>
</html>
