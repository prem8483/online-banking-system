<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Profile</title>

<style>
:root{
  --primary:#0050ff;
  --bg:#f4f6fb;
  --card:#fff;
  --text:#333;
  --muted:#777;
}

body{
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:var(--bg);
}

.topbar{
  background:var(--primary);
  color:white;
  padding:14px 22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.topbar a{
  color:white;
  margin-left:14px;
  text-decoration:none;
  font-size:14px;
}

.container{
  max-width:1100px;
  margin:40px auto;
  padding:0 16px;
}

.card{
  background:var(--card);
  border-radius:16px;
  box-shadow:0 12px 30px rgba(0,0,0,0.08);
  padding:30px;
  margin-bottom:25px;
}

.header{
  display:flex;
  align-items:center;
  gap:20px;
  margin-bottom:30px;
}

.avatar{
  width:90px;
  height:90px;
  border-radius:50%;
  background:var(--primary);
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:36px;
  font-weight:bold;
}

.section-title{
  color:var(--primary);
  margin-bottom:15px;
  font-size:18px;
  border-bottom:2px solid #eef1ff;
  padding-bottom:6px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:18px 25px;
}

.field label{
  font-size:13px;
  color:var(--muted);
}

.field div{
  font-size:15px;
  font-weight:500;
  margin-top:4px;
}

.actions{
  margin-top:30px;
  display:flex;
  gap:15px;
}

.btn{
  flex:1;
  padding:14px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  font-weight:bold;
  font-size:15px;
}

.btn-primary{
  background:var(--primary);
  color:white;
}

.btn-secondary{
  background:#eef1ff;
  color:var(--primary);
}

@media(max-width:768px){
  .grid{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<div class="topbar">
  <div><b>Online Bank</b></div>
  <div>
    <a href="user-dashboard.html">Dashboard</a>
    <a href="user-account.html">Accounts</a>
    <a href="user-nominee.html">Nominee</a>
    <a href="user-transactions.html">Transactions</a>
    <a href="user-transactions-send.html">Transfer</a>
    <a href="user-profile.html">Profile</a>
    <a href="#" onclick="logout()">Logout</a>
  </div>
</div>

<div class="container">

<div class="card">
  <div class="header">
    <div class="avatar" id="avatar">U</div>
    <div>
      <h2 id="name"></h2>
      <p id="email"></p>
    </div>
  </div>

  <!-- PERSONAL -->
  <div class="section-title">Personal Information</div>
  <div class="grid">
    <div class="field"><label>Phone</label><div id="phone"></div></div>
    <div class="field"><label>Gender</label><div id="gender"></div></div>
    <div class="field"><label>Date of Birth</label><div id="dob"></div></div>
    <div class="field"><label>Nationality</label><div id="nationality"></div></div>
    <div class="field"><label>Occupation</label><div id="occupation"></div></div>
    <div class="field"><label>Annual Income</label><div id="income"></div></div>
    <div class="field"><label>Marital Status</label><div id="marital"></div></div>
  </div>

  <!-- KYC -->
  <div class="section-title" style="margin-top:30px;">KYC Details</div>
  <div class="grid">
    <div class="field"><label>Aadhaar Number</label><div id="aadhaar"></div></div>
    <div class="field"><label>PAN Number</label><div id="pan"></div></div>
    <div class="field"><label>Account Type</label><div id="accountType"></div></div>
  </div>

  <!-- ADDRESS -->
  <div class="section-title" style="margin-top:30px;">Address</div>
  <div class="grid">
    <div class="field"><label>Address</label><div id="address"></div></div>
    <div class="field"><label>City</label><div id="city"></div></div>
    <div class="field"><label>State</label><div id="state"></div></div>
    <div class="field"><label>Pincode</label><div id="pincode"></div></div>
    <div class="field"><label>Account Created</label><div id="created"></div></div>
  </div>

  <div class="actions">
    <button class="btn btn-primary" onclick="location.href='user-edit-profile.html'">
      Edit Profile
    </button>
    <button class="btn btn-secondary" onclick="location.href='user-change-password.html'">
      Change Password
    </button>
  </div>

</div>
</div>

<script>
let userId = localStorage.getItem("userId");
if(!userId) location.href="user-login.html";

async function loadProfile(){
  const res = await fetch(`http://localhost:8080/api/users/${userId}`);
  const u = await res.json();

  avatar.innerText = u.name.charAt(0).toUpperCase();
  name.innerText = u.name;
  email.innerText = u.email;
  phone.innerText = u.phone;
  gender.innerText = u.gender;
  dob.innerText = u.dob;
  nationality.innerText = u.nationality;
  occupation.innerText = u.occupation;
  income.innerText = u.annualIncome;
  marital.innerText = u.maritalStatus;

  // üîê MASKED
  aadhaar.innerText = "XXXX XXXX " + u.aadharNumber.slice(-4);
  pan.innerText = u.panNumber.slice(0,5) + "****";

  accountType.innerText = u.accountType;
  address.innerText = u.address;
  city.innerText = u.city;
  state.innerText = u.state;
  pincode.innerText = u.pincode;
  created.innerText = u.createdAt.replace("T"," ");
}

loadProfile();

function logout(){
  localStorage.removeItem("userId");
  location.href="user-login.html";
}
</script>

</body>
</html>
